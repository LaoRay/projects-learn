webpackJsonp([8],{2:function(t,e){"use strict";function n(t){$http.defaults.headers.Authorization=t}Object.defineProperty(e,"__esModule",{value:!0});var i=window.CONFIG.DEV?window.CONFIG.API_DEV:window.CONFIG.API_HOST,o=function(t){window.alert(t)};$http.defaults.headers.sessionId=window.sessionStorage.getItem("sessionId");var s={SUCCESS:"0",TIMEOUT:"500",TOKEN_INVALID:"5001",CODE_INVALID:"5002"};$http.interceptors.response.use(function(t){var e=t.meta&&t.meta.code+"";switch(e){case s.SUCCESS:return t;case s.TOKEN_INVALID:case s.CODE_INVALID:return window.sessionStorage.removeItem("sessionId"),$http.defaults.headers.sessionId=void 0,o(t.meta.message||"当前会话已过期"),setTimeout(function(){window.location.href="toon://mwap/window?params="+JSON.stringify({functionType:1})},2e3),Promise.reject(t);default:return Promise.reject(t)}},function(t){return Promise.reject(t)});e.getSessionId=function(t,e,n){function o(t,n){return window.sessionStorage.setItem("Authorization",t),$http.defaults.headers.Authorization=t,e&&e(n)}return window.sessionStorage.getItem("Authorization")?o(window.sessionStorage.getItem("Authorization")):void $http.post(i+"/v1/open/getSessionId?code="+t).then(function(t){if(0===t.meta.code)return o(t.data.tokenType+";"+t.data.accessToken,t)}).catch(function(t){return n&&n(t)})},e.serverTime=function(){return sessionStorage.getItem("Authorization")&&n(sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(i+"/time/range").then(function(e){t(e)}).catch(function(t){e(t)})})},e.userInfo=function(){return sessionStorage.getItem("Authorization")&&n(sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(i+"/user/info").then(function(e){t(e)}).catch(function(t){e(t)})})},e.ticketList=function(t,e){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(n,o){$http.get(i+"/ticket/listByProductId?productId="+t,e).then(function(t){n(t)}).catch(function(t){o(t)})})},e.ticketChange=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/ticket/change",t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.ticketListByOrderNo=function(){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(i+"/ticket/listByOrderNo/"+params).then(function(e){t(e)}).catch(function(t){e(t)})})},e.ticketRefund=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/ticket/refund",{tid:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderCreate=function(t){return sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/order/save",t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderDetail=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.get(i+"/order/details/"+t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderCancel=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/order/cancel",{orderno:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderPay=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/order/pay",{orderno:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderPayCallback=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/v1/open/queryOrder",t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderList=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.get(i+"/order/list/"+t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderDelete=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/order/delete",{orderno:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.listCanRefundOrChange=function(){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(i+"/ticket/listCanRefundOrChange").then(function(e){t(e)}).catch(function(t){e(t)})})},e.ticketDetails=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.get(i+"/ticket/info/"+t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.goPay=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/v1/open/pay",t).then(function(t){e(t)}).catch(function(t){n(t)})})}},30:function(t,e,n){n(164);var i=n(1)(n(103),n(273),"data-v-47cac85e",null);t.exports=i.exports},103:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(127),s=i(o);e.default=s.default},127:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=n(2);e.default={name:"ticketChange",data:function(){return{title:"改签",infoShow:!0,ticketInfo:{manNum:2},isShow:!0}},watch:{$route:"setDate"},methods:{init:function(){this.resetData("all"),$util.setTitle("改签"),this.getTicketInfo()},resetData:function(t){switch(t){case"all":}},chooseDate:function(){this.$router.push({name:"browseDate"})},setDate:function(){return(0,i.sessionData)("setDate")?(0,i.sessionData)("setDate").date:"请选择日期"},clickInfoShow:function(){this.infoShow=!1},getTicketInfo:function(){var t=this,e=this.$route.params.id;window.navigator&&window.navigator.onLine?(0,o.ticketDetails)(e).then(function(e){0===e.meta.code&&(t.ticketInfo=e.data)}).catch(function(t){$util.toast({visible:!0,message:t.meta.message,position:"middle"})}):$util.toast({visible:!0,message:"网络异常，请检查网络设置",position:"middle"})},ticketChange:function(t){var e=this;window.navigator&&window.navigator.onLine?(0,o.ticketChange)({tid:t.tid,usetime:this.$refs.setDate.innerText}).then(function(t){0===t.meta.code&&($util.toast({visible:!0,message:"改签成功",position:"middle"}),e.$router.go(-1))}).catch(function(t){$util.toast({visible:!0,message:t.meta.message,position:"middle"})}):$util.toast({visible:!0,message:"网络异常，请检查网络设置",position:"middle"})}},beforeRouteEnter:function(t,e,n){n(function(t){"/change/date"===e.path&&(t.isShow=!1)})},activated:function(){this.init()},mounted:function(){}}},164:function(t,e){},273:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ticket-change"},[n("div",{staticClass:"ticket-container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.infoShow,expression:"infoShow"}],staticClass:"info icon icon-info",on:{click:t.clickInfoShow}},[n("i",{staticClass:"icon icon-close2"})]),t._v(" "),n("div",{staticClass:"ticket-content"},[n("h3",[t._v(t._s(t.ticketInfo.ticketName))]),t._v(" "),n("div",{staticClass:"ticket-item"},[t._v("\n        类型\n        "),n("span",[t._v(t._s(2===t.ticketInfo.ticketType?"半价票":"全价票"))])]),t._v(" "),n("div",{staticClass:"ticket-item"},[t._v("\n        人数\n        "),n("span",[t._v(t._s(t.ticketInfo.manNum)+" 人")])]),t._v(" "),n("div",{staticClass:"ticket-item"},[t._v("\n        票价\n        "),n("span",[t._v(t._s(t.ticketInfo.singlePrice?t.ticketInfo.singlePrice.toFixed(2):0)+" 元")])]),t._v(" "),n("div",{staticClass:"ticket-item"},[t._v("\n        总金额\n        "),n("span",[t._v(t._s(t.ticketInfo.singlePrice?(t.ticketInfo.singlePrice*t.ticketInfo.manNum).toFixed(2):0)+" 元")])]),t._v(" "),n("div",{staticClass:"ticket-item"},[t._v("\n        票号\n        "),n("span",[t._v(t._s(t.ticketInfo.tid))])]),t._v(" "),n("div",{staticClass:"ticket-item"},[t._v("\n        浏览日期\n        "),n("span",[t._v(t._s(t.ticketInfo.useTime))])])]),t._v(" "),n("div",{staticClass:"change-date"},[t._v("\n      改签日期\n      "),t._v(" "),n("div",{staticClass:"c-date",on:{click:t.chooseDate}},[n("span",{directives:[{name:"show",rawName:"v-show",value:!t.isShow,expression:"!isShow"}],ref:"setDate"},[t._v(t._s(t.setDate()))]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}]},[t._v(" 请选择改签日期")]),t._v(" "),n("i",{staticClass:"icon icon-forword2"})])]),t._v(" "),n("div",{staticClass:"change-btn"},[n("button",{on:{click:function(e){t.ticketChange(t.ticketInfo)}}},[t._v("确认改签")])])])])},staticRenderFns:[]}}});