webpackJsonp([0],{2:function(t,e){"use strict";function n(t){$http.defaults.headers.Authorization=t}Object.defineProperty(e,"__esModule",{value:!0});var o=window.CONFIG.DEV?window.CONFIG.API_DEV:window.CONFIG.API_HOST,i=function(t){window.alert(t)};$http.defaults.headers.sessionId=window.sessionStorage.getItem("sessionId");var s={SUCCESS:"0",TIMEOUT:"500",TOKEN_INVALID:"5001",CODE_INVALID:"5002"};$http.interceptors.response.use(function(t){var e=t.meta&&t.meta.code+"";switch(e){case s.SUCCESS:return t;case s.TOKEN_INVALID:case s.CODE_INVALID:return window.sessionStorage.removeItem("sessionId"),$http.defaults.headers.sessionId=void 0,i(t.meta.message||"当前会话已过期"),setTimeout(function(){window.location.href="toon://mwap/window?params="+JSON.stringify({functionType:1})},2e3),Promise.reject(t);default:return Promise.reject(t)}},function(t){return Promise.reject(t)});e.getSessionId=function(t,e,n){function i(t,n){return window.sessionStorage.setItem("Authorization",t),$http.defaults.headers.Authorization=t,e&&e(n)}return window.sessionStorage.getItem("Authorization")?i(window.sessionStorage.getItem("Authorization")):void $http.post(o+"/v1/open/getSessionId?code="+t).then(function(t){if(0===t.meta.code)return i(t.data.tokenType+";"+t.data.accessToken,t)}).catch(function(t){return n&&n(t)})},e.serverTime=function(){return sessionStorage.getItem("Authorization")&&n(sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(o+"/time/range").then(function(e){t(e)}).catch(function(t){e(t)})})},e.userInfo=function(){return sessionStorage.getItem("Authorization")&&n(sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(o+"/user/info").then(function(e){t(e)}).catch(function(t){e(t)})})},e.ticketList=function(t,e){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(n,i){$http.get(o+"/ticket/listByProductId?productId="+t,e).then(function(t){n(t)}).catch(function(t){i(t)})})},e.ticketChange=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(o+"/ticket/change",t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.ticketListByOrderNo=function(){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(o+"/ticket/listByOrderNo/"+params).then(function(e){t(e)}).catch(function(t){e(t)})})},e.ticketRefund=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(o+"/ticket/refund",{tid:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderCreate=function(t){return sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(o+"/order/save",t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderDetail=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.get(o+"/order/details/"+t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderCancel=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(o+"/order/cancel",{orderno:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderPay=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(o+"/order/pay",{orderno:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderPayCallback=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(o+"/v1/open/queryOrder",t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderList=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.get(o+"/order/list/"+t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderDelete=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(o+"/order/delete",{orderno:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.listCanRefundOrChange=function(){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(o+"/ticket/listCanRefundOrChange").then(function(e){t(e)}).catch(function(t){e(t)})})},e.ticketDetails=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.get(o+"/ticket/info/"+t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.goPay=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(o+"/v1/open/pay",t).then(function(t){e(t)}).catch(function(t){n(t)})})}},20:function(t,e,n){n(157);var o=n(1)(n(93),n(266),"data-v-30ad43c4",null);t.exports=o.exports},93:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(116),s=o(i);e.default=s.default},116:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),i=n(3);e.default={data:function(){return{title:"门票购买首页",iconSrc:n(206),dataList:[{title:"避暑山庄及周围寺庙景区",id:17,cover:n(202)},{title:"白草洼景区",id:6,cover:n(203)},{title:"承德大剧院",id:15,cover:n(204)},{title:"金山岭长城",id:20,cover:n(205)}]}},methods:{init:function(){if(this.resetData("all"),$util.setTitle("门票购买首页"),window.navigator&&window.navigator.onLine){if(!window.sessionStorage.getItem("Authorization")){var t=(0,i.getQueryString)("code")||"5ef8392e-751e-360e-8b1c-7053d66a6772";(0,o.getSessionId)(t,function(t){(0,o.userInfo)().then(function(t){0===t.meta.code&&(0,i.sessionData)("userInfo",t.data)}).catch(function(t){$util.toast({visible:!0,message:t.meta.message,position:"middle"})})},function(t){$util.toast({visible:!0,message:t.meta.message,position:"middle"})})}(0,o.serverTime)().then(function(t){0===t.meta.code&&(window.sessionStorage.setItem("currentTime",JSON.stringify(t.data.currentDay)),window.sessionStorage.setItem("serverTime",JSON.stringify(t.data)))}).catch(function(t){$util.toast({visible:!0,message:t.meta.message,position:"middle"})})}else $util.toast({visible:!0,message:"网络异常，请检查网络设置",position:"middle"})},iconEVent:function(){this.$router.push({name:"manage"})},itemListEVent:function(t){this.$router.push({name:"ticketType",params:{id:t.id}})},resetData:function(t){switch(t){case"all":}}},beforeRouteEnter:function(t,e,n){n()},beforeRouteLeave:function(t,e,n){return t.path.indexOf("/detail/order/create/pay/result")===-1&&t.path.indexOf("/mange/change/")==-1&&void n()},activated:function(){this.init()},mounted:function(){}}},157:function(t,e){},202:function(t,e,n){t.exports=n.p+"static/images/bg1@3x.dbd6eaa.png"},203:function(t,e,n){t.exports=n.p+"static/images/bg2@3x.f489819.png"},204:function(t,e,n){t.exports=n.p+"static/images/bg3@3x.0c39daf.png"},205:function(t,e,n){t.exports=n.p+"static/images/bg4@3x.b9d3b3d.png"},206:function(t,e,n){t.exports=n.p+"static/images/ticket-in@2x.547fb83.png"},266:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"by-app by-ticket"},[n("div",{staticClass:"by-ticket-container"},t._l(t.dataList,function(e,o){return n("div",{key:o,staticClass:"by-ticket-box",on:{click:function(n){t.itemListEVent(e)}}},[n("img",{attrs:{src:e.cover,alt:e.title}}),t._v(" "),n("h3",[t._v(t._s(e.title))])])})),t._v(" "),n("div",{staticClass:"by-ticket-manage"},[n("router-link",{attrs:{tag:"div",to:{path:"/manage"}}})],1)])},staticRenderFns:[]}}});