webpackJsonp([2],{2:function(t,e){"use strict";function n(t){$http.defaults.headers.Authorization=t}Object.defineProperty(e,"__esModule",{value:!0});var i=window.CONFIG.DEV?window.CONFIG.API_DEV:window.CONFIG.API_HOST,o=function(t){window.alert(t)};$http.defaults.headers.sessionId=window.sessionStorage.getItem("sessionId");var s={SUCCESS:"0",TIMEOUT:"500",TOKEN_INVALID:"5001",CODE_INVALID:"5002"};$http.interceptors.response.use(function(t){var e=t.meta&&t.meta.code+"";switch(e){case s.SUCCESS:return t;case s.TOKEN_INVALID:case s.CODE_INVALID:return window.sessionStorage.removeItem("sessionId"),$http.defaults.headers.sessionId=void 0,o(t.meta.message||"当前会话已过期"),setTimeout(function(){window.location.href="toon://mwap/window?params="+JSON.stringify({functionType:1})},2e3),Promise.reject(t);default:return Promise.reject(t)}},function(t){return Promise.reject(t)});e.getSessionId=function(t,e,n){function o(t,n){return window.sessionStorage.setItem("Authorization",t),$http.defaults.headers.Authorization=t,e&&e(n)}return window.sessionStorage.getItem("Authorization")?o(window.sessionStorage.getItem("Authorization")):void $http.post(i+"/v1/open/getSessionId?code="+t).then(function(t){if(0===t.meta.code)return o(t.data.tokenType+";"+t.data.accessToken,t)}).catch(function(t){return n&&n(t)})},e.serverTime=function(){return sessionStorage.getItem("Authorization")&&n(sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(i+"/time/range").then(function(e){t(e)}).catch(function(t){e(t)})})},e.userInfo=function(){return sessionStorage.getItem("Authorization")&&n(sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(i+"/user/info").then(function(e){t(e)}).catch(function(t){e(t)})})},e.ticketList=function(t,e){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(n,o){$http.get(i+"/ticket/listByProductId?productId="+t,e).then(function(t){n(t)}).catch(function(t){o(t)})})},e.ticketChange=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/ticket/change",t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.ticketListByOrderNo=function(){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(i+"/ticket/listByOrderNo/"+params).then(function(e){t(e)}).catch(function(t){e(t)})})},e.ticketRefund=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/ticket/refund",{tid:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderCreate=function(t){return sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/order/save",t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderDetail=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.get(i+"/order/details/"+t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderCancel=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/order/cancel",{orderno:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderPay=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/order/pay",{orderno:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderPayCallback=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/v1/open/queryOrder",t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderList=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.get(i+"/order/list/"+t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.orderDelete=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/order/delete",{orderno:t}).then(function(t){e(t)}).catch(function(t){n(t)})})},e.listCanRefundOrChange=function(){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(t,e){$http.get(i+"/ticket/listCanRefundOrChange").then(function(e){t(e)}).catch(function(t){e(t)})})},e.ticketDetails=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.get(i+"/ticket/info/"+t).then(function(t){e(t)}).catch(function(t){n(t)})})},e.goPay=function(t){return window.sessionStorage.getItem("Authorization")&&n(window.sessionStorage.getItem("Authorization")),new Promise(function(e,n){$http.post(i+"/v1/open/pay",t).then(function(t){e(t)}).catch(function(t){n(t)})})}},8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=n(2);e.default={name:"ListItem",props:["orderInfo","type"],data:function(){return{}},methods:{orderCancel:function(t){(0,i.confirm)({show:!0,title:"",message:"确认取消订单?",btnEscFun:function(){},btnOkFun:function(){(0,o.orderCancel)(t.epOrderNo).then(function(t){0===t.meta.code&&t.data&&($util.toast({visible:!0,message:"订单已取消",position:"middle"}),window.location.reload())}).catch(function(t){$util.toast({visible:!0,message:t.meta.message,position:"middle"})})}})},orderDeleteEvent:function(t){(0,i.confirm)({show:!0,title:"确认删除订单?",message:"删除后在购票凭证将不再显示",btnEscFun:function(){},btnOkFun:function(){(0,o.orderDelete)(t.epOrderNo).then(function(t){0===t.meta.code&&t.data&&($util.toast({visible:!0,message:"订单已删除",position:"middle"}),window.location.reload())}).catch(function(t){$util.toast({visible:!0,message:t.meta.message,position:"middle"})})}})},orderPay:function(t){this.$router.push({name:"ticketDetail",params:{id:t.groupNo}})},orderUseing:function(t){this.$router.push({name:"ticketDetail",params:{id:t.epOrderNo}})},listOrderDetails:function(t){this.$router.push({name:"ticketDetail",params:{id:t.groupNo}})}}}},9:function(t,e){},11:function(t,e,n){n(9);var i=n(1)(n(8),n(12),"data-v-6366a384",null);t.exports=i.exports},12:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list-item"},[n("div",{staticClass:"list-box",on:{click:function(e){t.listOrderDetails(t.orderInfo)}}},[n("div",{staticClass:"list-inner",staticStyle:{height:"24px"}},[n("h3",[t._v(t._s(t.orderInfo.ticketName))]),t._v(" "),n("span",[t._v("x "+t._s(t.orderInfo.manNum))])]),t._v(" "),n("div",{staticClass:"list-inner"},[t._v("订单号: "+t._s(t.orderInfo.epOrderNo))]),t._v(" "),n("div",{staticClass:"list-inner"},[t._v("下单时间: "+t._s(t.orderInfo.addTime))]),t._v(" "),n("div",{staticClass:"list-inner"},[t._v("订单金额: "+t._s(t.orderInfo.amount?t.orderInfo.amount.toFixed(2):0)+"元")])]),t._v(" "),n("div",{staticClass:"list-status border-top"},[1===t.orderInfo.flag?n("div",{staticClass:"list"},[t._m(0),t._v(" "),n("div",{staticClass:"status-btn"},[n("button",{staticClass:"border",on:{click:function(e){t.orderPay(t.orderInfo)}}},[t._v(" 去支付")])])]):t._e(),t._v(" "),2===t.orderInfo.flag?n("div",{staticClass:"list"},[n("div",{staticClass:"status-text"},[n("span",{staticClass:"list-text",class:[t.orderInfo.flag?"useing":""]},[t._v(" 已支付")])]),t._v(" "),n("div",{staticClass:"status-btn"},[n("button",{staticClass:"border",on:{click:function(e){t.listOrderDetails(t.orderInfo)}}},[t._v("查看详情")])])]):t._e(),t._v(" "),3===t.orderInfo.flag?n("div",{staticClass:"list"},[t._m(1),t._v(" "),n("div",{staticClass:"status-btn"},[n("button",{staticClass:"border",on:{click:function(e){t.orderDeleteEvent(t.orderInfo)}}},[t._v("删除订单")])])]):t._e(),t._v(" "),4===t.orderInfo.flag?n("div",{staticClass:"list"},[n("div",{staticClass:"status-text"},[n("span",{staticClass:"list-text",class:[t.orderInfo.flag?"already":""]},[t._v(" 已取消")])]),t._v(" "),n("div",{staticClass:"status-btn"},[n("button",{staticClass:"border",on:{click:function(e){t.orderDeleteEvent(t.orderInfo)}}},[t._v("删除订单")])])]):t._e(),t._v(" "),8===t.orderInfo.flag?n("div",{staticClass:"list"},[t._m(2),t._v(" "),n("div",{staticClass:"status-btn"},[n("button",{staticClass:"border",on:{click:function(e){t.orderPay(t.orderInfo)}}},[t._v("去支付")])])]):t._e(),t._v(" "),9===t.orderInfo.flag?n("div",{staticClass:"list"},[n("div",{staticClass:"status-text"},[n("span",{staticClass:"list-text",class:[t.orderInfo.flag?"already":""]},[t._v(" 订单异常")])]),t._v(" "),n("div",{staticClass:"status-btn"},[n("button",{staticClass:"border",on:{click:function(e){t.listOrderDetails(t.orderInfo)}}},[t._v("查看详情")])])]):t._e()])])},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"status-text"},[n("span",{staticClass:"list-text",staticStyle:{color:"#FF3B2F"}},[t._v(" 未支付")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"status-text"},[n("span",{staticClass:"list-text",staticStyle:{color:"#4A4A4A"}},[t._v(" 已失效")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"status-text"},[n("span",{staticClass:"list-text",staticStyle:{color:"#FF9219"}},[t._v(" 处理中")])])}]}},33:function(t,e,n){n(143);var i=n(1)(n(106),n(253),"data-v-15c934e0",null);t.exports=i.exports},106:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(130),s=i(o);e.default=s.default},130:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},s=n(3),r=n(11),a=i(r),c=n(2),u=n(6);e.default={name:"ticketProof",data:function(){return{title:"购票凭证",tabList:[{title:"全部",id:"0"},{title:"待支付",id:"1"},{title:"已支付",id:"2"},{title:"已失效",id:"3"}],nodata:!1,orderList:[],isActive:0}},components:{ListItem:a.default},computed:o({},u.mapGetters.getIsActive),methods:{init:function(){this.resetData("all"),$util.setTitle("购票凭证"),window.sessionStorage&&window.sessionStorage.getItem("isActive")?(this.isActive=window.sessionStorage.getItem("isActive"),this.getOrderList(this.isActive)):(this.isActive="0",this.getOrderList(this.isActive))},resetData:function(t){switch(t){case"all":}},getOrderList:function(t){var e=this;this.isActive=t,window.navigator&&window.navigator.onLine?(window.sessionStorage.setItem("isActive",t),(0,c.orderList)(t).then(function(t){0===t.meta.code&&(t.data&&0===t.data.length?e.nodata=!0:(e.nodata=!1,e.orderList=[],t.data.forEach(function(t,n){t.addTime=(0,s.dateFormat)("yyyy-MM-dd hh:mm:ss",t.addTime),e.orderList.push(t)})))}).catch(function(t){console.log(t),t&&$util.toast({visible:!0,message:t.meta.message,position:"middle"})})):$util.toast({visible:!0,message:"网络异常，请检查网络设置",position:"middle"})}},beforeRouteEnter:function(t,e,n){"/manage"===e.path&&window.sessionStorage.setItem("isActive",0),n()},activated:function(){},mounted:function(){this.init()}}},143:function(t,e){},253:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ticket-proof"},[n("div",{staticClass:"tab-btn border-bottom"},t._l(t.tabList,function(e,i){return n("button",{key:e.id,on:{click:function(n){t.getOrderList(e.id)}}},[n("span",{class:[t.isActive==e.id?"active":""]},[t._v(t._s(e.title))])])})),t._v(" "),n("div",{staticClass:"proof-container"},[n("div",{staticClass:"tab-content",staticStyle:{"padding-top":"44px"}},[t.nodata?n("div",{staticClass:"icon-box"},[n("div",{staticClass:"icon icon-nodata"}),t._v(" "),n("h3",[t._v("暂无订单信息")])]):t._e(),t._v(" "),t._l(t.orderList,function(e,i){return t.nodata?t._e():n("ListItem",{key:i,attrs:{type:0,orderInfo:e}})})],2)])])},staticRenderFns:[]}}});